<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ù…ÙˆÙ„Ø¯ Ø±Ù…ÙˆØ² QR Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
  
  <!-- Ù…ÙƒØªØ¨Ø© ØªÙˆÙ„ÙŠØ¯ Ø±Ù…Ø² QR -->
  <script src="https://unpkg.com/qr-code-styling/lib/qr-code-styling.js"></script>
  
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      text-align: center;
      transition: background-color 0.3s, color 0.3s;
      -webkit-transition: background-color 0.3s, color 0.3s;
    }
    /* Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± */
    #theme-toggle {
      position: fixed;
      top: 20px;
      left: 20px;
      background: transparent;
      border: none;
      font-size: 32px;
      cursor: pointer;
      z-index: 1000;
      transition: transform 0.3s;
      -webkit-transition: transform 0.3s;
    }
    #theme-toggle:hover {
      transform: scale(1.2);
      -webkit-transform: scale(1.2);
    }
    .container {
      max-width: 500px;
      margin: 40px auto 20px auto;
      padding: 20px;
      border-radius: 10px;
      transition: background-color 0.3s, color 0.3s;
      -webkit-transition: background-color 0.3s, color 0.3s;
    }
    .section {
      margin-top: 20px;
      text-align: left;
    }
    h1, h2, label {
      margin: 10px 0 5px;
    }
    input, select, button {
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
    }
    button {
      cursor: pointer;
    }
    /* Ø²Ø± Style Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„ */
    #style-toggle {
      background-color: #4caf50;
      color: #fff;
      border: none;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      font-size: 16px;
      transition: background-color 0.3s;
      -webkit-transition: background-color 0.3s;
    }
    #style-toggle:hover {
      background-color: #45a049;
    }
    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø·ÙŠ (Ø¬Ù…ÙŠØ¹ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ…) */
    #style-options {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
      -webkit-transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
    }
    #style-options.expanded {
      max-height: 1000px; /* Ø±Ù‚Ù… ÙƒØ¨ÙŠØ± ÙŠØ³ØªÙˆØ¹Ø¨ ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
      opacity: 1;
    }
    /* Ø²Ø± Ø§Ù„Ù†Ø¬Ù…Ø© Ù„ÙƒÙ„ Ù‚Ø³Ù… (Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ¸ÙŠÙØ© Accordion ÙØ±Ø¹ÙŠ) */
    .accordion-toggle {
      background: transparent;
      border: none;
      font-size: 18px;
      cursor: pointer;
      margin-left: 10px;
      color: gold;
      transition: transform 0.2s;
      -webkit-transition: transform 0.2s;
    }
    .accordion-toggle:hover {
      transform: scale(1.2);
      -webkit-transform: scale(1.2);
    }
    /* Ù…Ø­ØªÙˆÙ‰ ÙƒÙ„ Ù‚Ø³Ù… Accordion ÙØ±Ø¹ÙŠ */
    .accordion-content {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
      -webkit-transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
      margin-bottom: 10px;
    }
    .accordion-content.expanded {
      max-height: 500px;
      opacity: 1;
    }
    /* Ø­Ø§ÙˆÙŠØ© Ø±Ù…Ø² QR */
    .qr-container {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 20px auto;
    }
    #qr-code {
      width: 100%;
      height: 100%;
    }
    /* ØµÙˆØ±Ø© Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙÙˆÙ‚ Ø±Ù…Ø² QR */
    #logo-img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      border: none;
      box-shadow: none;
    }
    /* Ø´Ø¨ÙƒØ© Ø§Ù„Ø£Ø´ÙƒØ§Ù„ */
    .shapes-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }
    .shape-option {
      width: 50px;
      height: 50px;
      background-color: #333;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      border: 2px solid transparent;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
    }
    .shape-option:hover {
      border-color: #aaa;
    }
    .shape-option.active {
      border-color: #4caf50;
    }
    .shape-option span {
      color: #fff;
      text-shadow: 0 0 2px #000;
    }
  </style>
</head>
<body>
  <!-- Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø± -->
  <button id="theme-toggle" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">â˜€ï¸</button>
  
  <div class="container">
    <h1>Ù…ÙˆÙ„Ø¯ Ø±Ù…ÙˆØ² QR Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
    
    <!-- Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Øµ -->
    <div class="section">
      <input type="text" id="input-data" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ø£Ùˆ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§..." dir="ltr"/>
    </div>
    
    <!-- Ø²Ø± Style Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <button id="style-toggle">Style â˜…</button>
    
    <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø·ÙŠ (Ø¬Ù…ÙŠØ¹ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ…) -->
    <div id="style-options">
      
      <!-- ====== Ù‚Ø³Ù… Ø£Ø´ÙƒØ§Ù„ Ø¬Ø³Ù… Ø§Ù„Ù€QR (Body) ====== -->
      <div class="section">
        <h2>
          Ø£Ø´ÙƒØ§Ù„ Ø¬Ø³Ù… Ø§Ù„Ù€QR (Body)
          <button class="accordion-toggle" data-target="body-content">â˜†</button>
        </h2>
        <div id="body-content" class="accordion-content">
          <div class="shapes-grid" id="body-shapes">
            <div class="shape-option active" data-value="square">
              <span>Square</span>
            </div>
            <div class="shape-option" data-value="dots">
              <span>Dots</span>
            </div>
            <div class="shape-option" data-value="rounded">
              <span>Rounded</span>
            </div>
            <div class="shape-option" data-value="classy">
              <span>Classy</span>
            </div>
            <div class="shape-option" data-value="classy-rounded">
              <span>Classy R.</span>
            </div>
            <div class="shape-option" data-value="extra-rounded">
              <span>Extra R.</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ====== Ù‚Ø³Ù… Ø¥Ø·Ø§Ø± Ø§Ù„Ø¹ÙŠÙˆÙ† (Eye Frame) ====== -->
      <div class="section">
        <h2>
          Ø¥Ø·Ø§Ø± Ø§Ù„Ø¹ÙŠÙˆÙ† (Eye Frame)
          <button class="accordion-toggle" data-target="eye-frame-content">â˜†</button>
        </h2>
        <div id="eye-frame-content" class="accordion-content">
          <div class="shapes-grid" id="eye-frame-shapes">
            <div class="shape-option active" data-value="square">
              <span>Square</span>
            </div>
            <div class="shape-option" data-value="dot">
              <span>Dot</span>
            </div>
            <div class="shape-option" data-value="rounded">
              <span>Rounded</span>
            </div>
            <div class="shape-option" data-value="extra-rounded">
              <span>Extra R.</span>
            </div>
            <div class="shape-option" data-value="classy">
              <span>Classy</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ====== Ù‚Ø³Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹ÙŠÙˆÙ† (Eye Ball) ====== -->
      <div class="section">
        <h2>
          Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¹ÙŠÙˆÙ† (Eye Ball)
          <button class="accordion-toggle" data-target="eye-ball-content">â˜†</button>
        </h2>
        <div id="eye-ball-content" class="accordion-content">
          <div class="shapes-grid" id="eye-ball-shapes">
            <div class="shape-option active" data-value="square">
              <span>Square</span>
            </div>
            <div class="shape-option" data-value="dot">
              <span>Dot</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- ====== Ù‚Ø³Ù… ØªØ®ØµÙŠØµ Ø§Ù„Ù„ÙˆØ¬Ùˆ ====== -->
      <div class="section">
        <h2>ØªØ®ØµÙŠØµ Ø§Ù„Ù„ÙˆØ¬Ùˆ</h2>
        <input type="file" id="logo-upload" accept="image/*"/>
        <label>Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© ÙØ¹Ù„ÙŠÙ‹Ø§ (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… remove.bg):</label>
        <input type="checkbox" id="remove-bg"/>
        <label>Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØ¬Ùˆ (% Ù…Ù† Ø±Ù…Ø² QR):</label>
        <input type="range" id="logo-size" min="10" max="100" value="30"/>
        <label>Ø­Ø¬Ù… Ø§Ù„Ù‡Ø§Ù„Ø© (Ø¨Ø§Ù„Ø¨ÙƒØ³Ù„):</label>
        <input type="range" id="halo-size" min="0" max="50" value="10"/>
        <label>Ø´ÙƒÙ„ Ø§Ù„Ù‡Ø§Ù„Ø©:</label>
        <select id="halo-shape">
          <option value="circle">Ø¯Ø§Ø¦Ø±ÙŠ</option>
          <option value="square">Ù…Ø±Ø¨Ù‘Ø¹</option>
        </select>
        <label>Ù„ÙˆÙ† Ø§Ù„Ù‡Ø§Ù„Ø©:</label>
        <input type="color" id="halo-color" value="#ffffff"/>
      </div>
    </div>
    
    <!-- Ø¹Ø±Ø¶ Ø±Ù…Ø² QR Ù…Ø¹ Ø§Ù„Ù„ÙˆØ¬Ùˆ -->
    <div class="qr-container">
      <div id="qr-code"></div>
      <img id="logo-img" src="" alt="Logo"/>
    </div>
    
    <!-- Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø±Ù…Ø² Ø§Ù„Ù€QR Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© -->
    <button id="download-btn">ØªØ­Ù…ÙŠÙ„ Ø±Ù…Ø² QR Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©</button>
  </div>
  
  <script>
    // ========== 1) Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„Ù†Ù‡Ø§Ø±ÙŠ ==========
    let isDark = true; // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¯Ø§ÙƒÙ†
    const themeToggleBtn = document.getElementById("theme-toggle");
    
    function applyTheme() {
      const body = document.body;
      const container = document.querySelector(".container");
      
      if (isDark) {
        body.style.backgroundColor = "#121212";
        body.style.color = "#fff";
        container.style.backgroundColor = "#222";
        container.style.color = "#fff";
        themeToggleBtn.textContent = "â˜€ï¸"; // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø´Ù…Ø³
      } else {
        body.style.backgroundColor = "#fff";
        body.style.color = "#000";
        container.style.backgroundColor = "#f0f0f0";
        container.style.color = "#000";
        themeToggleBtn.textContent = "ğŸŒš"; // Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ù…Ø±
      }
    }
    themeToggleBtn.addEventListener("click", () => {
      isDark = !isDark;
      applyTheme();
    });
    applyTheme();
    
    // ========== 2) Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø² QR Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙƒØªØ¨Ø© qr-code-styling ==========
    const REMOVE_BG_API_KEY = "9GvsbB8KT8vBbVH3F2CmwHer"; // ÙŠÙÙØ¶Ù‘Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¤Ù‡ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
    let currentBodyShape = "square";
    let currentEyeFrame = "square";
    let currentEyeBall = "square";
    
    const qrCode = new QRCodeStyling({
      width: 300,
      height: 300,
      data: "https://example.com",
      dotsOptions: { type: currentBodyShape, color: "#000000" },
      cornersSquareOptions: { type: currentEyeFrame },
      cornersDotOptions: { type: currentEyeBall }
    });
    qrCode.append(document.getElementById("qr-code"));
    
    function updateQRCode() {
      const data = document.getElementById("input-data").value || "https://example.com";
      let options = {
        data: data,
        dotsOptions: { type: currentBodyShape },
        cornersSquareOptions: { type: currentEyeFrame },
        cornersDotOptions: { type: currentEyeBall }
      };
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù„ÙˆØ¬Ùˆ Ù…ØªØ§Ø­Ù‹Ø§ (ÙˆÙ…Ø±ÙÙˆØ¹Ù‹Ø§)ØŒ Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø®ÙŠØ§Ø± image
      if (logoImg.src && logoImg.style.display !== "none") {
        options.image = logoImg.src;
        options.imageOptions = { crossOrigin: "anonymous", margin: 0 };
      }
      qrCode.update(options);
      document.getElementById("qr-code").innerHTML = "";
      qrCode.append(document.getElementById("qr-code"));
    }
    
    document.getElementById("input-data").addEventListener("input", updateQRCode);
    
    function setupShapeGrid(gridId, onChangeCallback) {
      const grid = document.getElementById(gridId);
      const items = grid.querySelectorAll(".shape-option");
      items.forEach(item => {
        item.addEventListener("click", () => {
          items.forEach(i => i.classList.remove("active"));
          item.classList.add("active");
          onChangeCallback(item.dataset.value);
          updateQRCode();
        });
      });
    }
    
    setupShapeGrid("body-shapes", val => currentBodyShape = val);
    setupShapeGrid("eye-frame-shapes", val => currentEyeFrame = val);
    setupShapeGrid("eye-ball-shapes", val => currentEyeBall = val);
    
    // ========== 3) Ø±ÙØ¹ Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙˆØ¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… remove.bg ==========
    const logoUpload = document.getElementById("logo-upload");
    const logoImg = document.getElementById("logo-img");
    
    logoUpload.addEventListener("change", async function(e) {
      const file = e.target.files[0];
      if (!file) return;
      const useRemoveBg = document.getElementById("remove-bg").checked;
      if (useRemoveBg) {
        try {
          const newSrc = await removeBackgroundFromImage(file);
          logoImg.src = newSrc;
          logoImg.style.display = "block";
          updateLogoStyle();
          updateQRCode();
        } catch (err) {
          alert("Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©: " + err.message);
        }
      } else {
        const reader = new FileReader();
        reader.onload = function(event) {
          logoImg.src = event.target.result;
          logoImg.style.display = "block";
          updateLogoStyle();
          updateQRCode();
        };
        reader.readAsDataURL(file);
      }
    });
    
    async function removeBackgroundFromImage(file) {
      const formData = new FormData();
      formData.append("image_file", file);
      formData.append("size", "auto");
      const response = await fetch("https://api.remove.bg/v1.0/removebg", {
        method: "POST",
        headers: { "X-Api-Key": REMOVE_BG_API_KEY },
        body: formData
      });
      if (!response.ok) {
        throw new Error(`remove.bg API Error: ${response.statusText}`);
      }
      const blob = await response.blob();
      return URL.createObjectURL(blob);
    }
    
    // ========== 4) Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙˆØ§Ù„Ù‡Ø§Ù„Ø© ==========
    function updateLogoStyle() {
      const logoSizeVal = document.getElementById("logo-size").value;
      const haloSizeVal = document.getElementById("halo-size").value;
      const haloShape = document.getElementById("halo-shape").value;
      const haloColor = document.getElementById("halo-color").value;
      
      const logoSizePx = 300 * (logoSizeVal / 100);
      logoImg.style.width = logoSizePx + "px";
      logoImg.style.height = "auto";
      
      // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø®Ù„ÙÙŠØ© + padding ÙƒÙ€ "Ù‡Ø§Ù„Ø©" Ø®Ù„Ù Ø§Ù„Ø´Ø¹Ø§Ø±
      logoImg.style.backgroundColor = haloColor;
      logoImg.style.padding = haloSizeVal + "px";
      logoImg.style.borderRadius = (haloShape === "circle") ? "50%" : "0";
    }
    
    document.getElementById("logo-size").addEventListener("input", () => { updateLogoStyle(); updateQRCode(); });
    document.getElementById("halo-size").addEventListener("input", () => { updateLogoStyle(); updateQRCode(); });
    document.getElementById("halo-shape").addEventListener("change", () => { updateLogoStyle(); updateQRCode(); });
    document.getElementById("halo-color").addEventListener("input", () => { updateLogoStyle(); updateQRCode(); });
    document.getElementById("remove-bg").addEventListener("change", () => {
      if (logoUpload.files[0]) {
        logoUpload.dispatchEvent(new Event("change"));
      }
    });
    
    // ========== 5) Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø±Ù…Ø² Ø§Ù„Ù€QR Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© ==========
    document.getElementById("download-btn").addEventListener("click", () => {
      qrCode.download({
        name: "qr-code",
        extension: "png",
        scale: 6
      });
    });
    
    // ========== 6) Ø²Ø± Style Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ… (Accordion Ø±Ø¦ÙŠØ³ÙŠ) ==========
    const styleToggleBtn = document.getElementById("style-toggle");
    const styleOptions = document.getElementById("style-options");
    let styleExpanded = false;
    styleToggleBtn.addEventListener("click", () => {
      styleExpanded = !styleExpanded;
      if (styleExpanded) {
        styleOptions.classList.add("expanded");
      } else {
        styleOptions.classList.remove("expanded");
      }
    });
    
    // ========== 7) Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø¬Ù…Ø© Ù„ÙƒÙ„ Ù‚Ø³Ù… (Accordion ÙØ±Ø¹ÙŠ) ==========
    const accordionToggles = document.querySelectorAll(".accordion-toggle");
    accordionToggles.forEach(toggleBtn => {
      toggleBtn.addEventListener("click", (e) => {
        if (toggleBtn.textContent.trim() === "â˜†") {
          toggleBtn.textContent = "â˜…";
        } else {
          toggleBtn.textContent = "â˜†";
        }
        const targetId = toggleBtn.dataset.target;
        const contentDiv = document.getElementById(targetId);
        contentDiv.classList.toggle("expanded");
        e.stopPropagation();
      });
    });
    
    // Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£ÙˆÙ„ÙŠ Ù„Ù„Ù€QR
    updateQRCode();
  </script>
</body>
</html>
